<!-- (scroll)="handleShowScrollArrow($event)" -->
<div class="app-root">
<div id="content-scrollable" class="container">
  
  <div *ngIf="!isLoginKiosk || (kioskStatus$ | async) === 'REGISTERED'; else kioskStatusBlock" 
       class="flex-container-column"
       [@routeAnimations]="prepareRoute(outlet)">
    <router-outlet #outlet="outlet"></router-outlet>
    <app-footer *ngIf="!helper.view"></app-footer>
    
    <!-- Panel de administraciÃ³n Global -->
    <app-administrative-module *ngIf="adminPanelOpen$ | async" (closeModal)="closeAdminPanel()"></app-administrative-module>
  </div>

  <!-- Template para bloqueos de estado del Kiosco -->
  <ng-template #kioskStatusBlock>
    <app-kiosk-guard></app-kiosk-guard>
  </ng-template>

  <!-- Carrusel de publicidad - Solo en vista de inicio -->
  <!-- ðŸš© DESHABILITADO: Para habilitar cambiar ENABLE_AD_CAROUSEL a true en app.component.ts -->
  <app-ad-carousel 
    *ngIf="showAdCarousel && !helper.view && !(adminPanelOpen$ | async)" 
    (touch)="hideAdCarousel()"
    (click)="hideAdCarousel()">
  </app-ad-carousel>

    <!-- * Arrow button to scroll up -->
    <!-- <button class="arrow_up animated faster" (click)="scrollToTop()" [class.fadeInUp]="showScrollArrow"
    [class.fadeOutDown]="!showScrollArrow">
    <img src="../assets/images/arrow_up.png" alt="Ir hacia arriba">
  </button> -->
</div>

  <!-- Pantalla de inactividad: iframe a pantalla completa (FONDO) -->
  <div class="idle-page-overlay" 
       [class.idle-page-overlay--visible]="showIdlePage" 
       [class.idle-page-overlay--going-to-pay]="isGoingToPay"
       [attr.aria-hidden]="!showIdlePage">
    <div class="idle-page-iframe-zone">
      <iframe [src]="idlePageUrlSafe" class="idle-page-iframe" title="PÃ¡gina de inactividad"></iframe>
    </div>
    <!-- EL BOTÃ“N SE MOVIÃ“ A NIVEL GLOBAL -->
  </div>

  <!-- BOTÃ“N GLOBAL INMORTAL (Visible solo en WelcomeView '/' y en IdlePage '/idle') -->
  <div class="idle-page-button-zone" 
       *ngIf="(currentRoute === '/' || currentRoute === '/idle') && !(adminPanelOpen$ | async) && (kioskStatus$ | async) === 'REGISTERED'"
       [class.idle-page-button-zone--hidden]="!showGlobalButton"
       (click)="handleGlobalStart()" 
       (touchstart)="handleGlobalStart()">
    <div class="idle-page-chevron" aria-hidden="true">
      <i class="fa fa-chevron-down"></i>
    </div>
    <button type="button" class="idle-page-btn">Empezar</button>
  </div>

</div>
